{
	"info": {
		"name": "Pawpong 후기 API",
		"description": "입양자 후기 작성, 조회, 개별 조회 API 테스트 컬렉션",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{accessToken}}",
				"type": "string"
			}
		]
	},
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:3000",
			"type": "string"
		},
		{
			"key": "accessToken",
			"value": "",
			"type": "string"
		},
		{
			"key": "breederId",
			"value": "",
			"type": "string"
		},
		{
			"key": "reviewId",
			"value": "",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "1. 후기 작성",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Status code is 201', function () {",
							"    pm.response.to.have.status(201);",
							"});",
							"",
							"pm.test('Response has reviewId', function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.data).to.have.property('reviewId');",
							"    ",
							"    if (jsonData.data.reviewId) {",
							"        pm.collectionVariables.set('reviewId', jsonData.data.reviewId);",
							"        console.log('✅ 후기 ID 저장:', jsonData.data.reviewId);",
							"    }",
							"});",
							"",
							"pm.test('Response has success message', function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.message).to.eql('후기가 성공적으로 작성되었습니다.');",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"breederId\": \"{{breederId}}\",\n  \"reviewType\": \"adoption\",\n  \"content\": \"정말 좋은 브리더입니다. 반려동물이 건강하고 성격도 좋아요. 분양 후에도 지속적으로 관리 방법을 알려주셔서 큰 도움이 되었습니다.\"\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/adopter/review",
					"host": ["{{baseUrl}}"],
					"path": ["adopter", "review"]
				},
				"description": "브리더에 대한 후기를 작성합니다.\n\n**필수 입력:**\n- breederId: 후기를 작성할 브리더 ID\n- reviewType: 후기 유형 (consultation 또는 adoption)\n- content: 후기 내용\n\n**자동 처리:**\n- adopterId는 JWT 토큰에서 자동 추출\n- 같은 브리더에 대한 중복 후기 작성 방지"
			},
			"response": []
		},
		{
			"name": "2. 후기 조회 (페이지네이션)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Status code is 200', function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test('Response has items and pagination', function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.data).to.have.property('items');",
							"    pm.expect(jsonData.data).to.have.property('pagination');",
							"});",
							"",
							"pm.test('Items have required fields', function () {",
							"    var jsonData = pm.response.json();",
							"    if (jsonData.data.items.length > 0) {",
							"        var item = jsonData.data.items[0];",
							"        pm.expect(item).to.have.property('reviewId');",
							"        pm.expect(item).to.have.property('breederNickname');",
							"        pm.expect(item).to.have.property('breederLevel');",
							"        pm.expect(item).to.have.property('breedingPetType');",
							"        pm.expect(item).to.have.property('content');",
							"        pm.expect(item).to.have.property('reviewType');",
							"        pm.expect(item).to.have.property('writtenAt');",
							"        ",
							"        console.log('✅ 첫 번째 후기:', item.breederNickname);",
							"    }",
							"});",
							"",
							"pm.test('Pagination has correct structure', function () {",
							"    var jsonData = pm.response.json();",
							"    var pagination = jsonData.data.pagination;",
							"    pm.expect(pagination).to.have.property('currentPage');",
							"    pm.expect(pagination).to.have.property('totalPages');",
							"    pm.expect(pagination).to.have.property('totalItems');",
							"    pm.expect(pagination).to.have.property('itemsPerPage');",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/adopter/reviews?page=1&limit=10",
					"host": ["{{baseUrl}}"],
					"path": ["adopter", "reviews"],
					"query": [
						{
							"key": "page",
							"value": "1",
							"description": "페이지 번호 (기본값: 1)"
						},
						{
							"key": "limit",
							"value": "10",
							"description": "페이지당 항목 수 (기본값: 10)"
						}
					]
				},
				"description": "입양자가 작성한 후기 목록을 페이지네이션과 함께 조회합니다.\n\n**반환 정보:**\n- 브리더 닉네임, 프로필 사진 URL, 레벨, 브리딩 동물 종류\n- 후기 내용, 후기 종류, 작성 일자\n- 최신순 정렬, 기본 10개씩"
			},
			"response": []
		},
		{
			"name": "3. 후기 개별 조회",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Status code is 200', function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test('Response has all required fields', function () {",
							"    var jsonData = pm.response.json();",
							"    var data = jsonData.data;",
							"    ",
							"    pm.expect(data).to.have.property('reviewId');",
							"    pm.expect(data).to.have.property('breederNickname');",
							"    pm.expect(data).to.have.property('breederLevel');",
							"    pm.expect(data).to.have.property('breedingPetType');",
							"    pm.expect(data).to.have.property('content');",
							"    pm.expect(data).to.have.property('reviewType');",
							"    pm.expect(data).to.have.property('writtenAt');",
							"    pm.expect(data).to.have.property('isVisible');",
							"    ",
							"    console.log('✅ 후기 상세:', data.breederNickname, '- 공개 여부:', data.isVisible);",
							"});",
							"",
							"pm.test('reviewType is valid', function () {",
							"    var jsonData = pm.response.json();",
							"    var reviewType = jsonData.data.reviewType;",
							"    pm.expect(['consultation', 'adoption']).to.include(reviewType);",
							"});",
							"",
							"pm.test('breederLevel is valid', function () {",
							"    var jsonData = pm.response.json();",
							"    var level = jsonData.data.breederLevel;",
							"    pm.expect(['new', 'elite']).to.include(level);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/adopter/reviews/{{reviewId}}",
					"host": ["{{baseUrl}}"],
					"path": ["adopter", "reviews", "{{reviewId}}"]
				},
				"description": "후기 ID로 특정 후기의 세부 정보를 조회합니다.\n\n**반환 정보:**\n- 브리더 닉네임, 프로필 사진 URL, 레벨, 브리딩 동물 종류\n- 후기 내용, 후기 종류, 작성 일자\n- 공개 여부 (isVisible)"
			},
			"response": []
		}
	]
}
